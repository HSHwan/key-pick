{% extends 'booking/base.html' %}

{% block title %}ë°©íƒˆì¶œ í…Œë§ˆ ëª©ë¡{% endblock %}

{% block content %}
    <h1>ë°©íƒˆì¶œ í…Œë§ˆ ëª©ë¡</h1>

    <div class="search-box" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 30px; border: 1px solid #ddd;">
        <form method="GET" action="{% url 'theme-list' %}" class="row g-3">
            
            <div class="col-md-4">
                <label class="form-label fw-bold">ê²€ìƒ‰ì–´</label>
                <input type="text" name="search_query" class="form-control" placeholder="í…Œë§ˆëª… ë˜ëŠ” ì¥ë¥´" value="{{ search_query }}">
            </div>

            <div class="col-md-3">
                <label class="form-label fw-bold">ì§€ì  ì„ íƒ</label>
                <select name="branch" class="form-select">
                    <option value="">ëª¨ë“  ì§€ì </option>
                    {% for branch in branches %}
                        <option value="{{ branch.branch_id }}" {% if selected_branch|stringformat:"s" == branch.branch_id|stringformat:"s" %}selected{% endif %}>
                            {{ branch.branch_name }}
                        </option>
                    {% endfor %}
                </select>
            </div>

            <div class="col-md-2">
                <label class="form-label fw-bold">ë‚œì´ë„</label>
                <select name="difficulty" class="form-select">
                    <option value="">ì „ì²´</option>
                    <option value="1" {% if selected_difficulty == "1" %}selected{% endif %}>â­ 1</option>
                    <option value="2" {% if selected_difficulty == "2" %}selected{% endif %}>â­â­ 2</option>
                    <option value="3" {% if selected_difficulty == "3" %}selected{% endif %}>â­â­â­ 3</option>
                    <option value="4" {% if selected_difficulty == "4" %}selected{% endif %}>â­â­â­â­ 4</option>
                    <option value="5" {% if selected_difficulty == "5" %}selected{% endif %}>â­â­â­â­â­ 5</option>
                </select>
            </div>

            <div class="col-md-3">
                <label class="form-label fw-bold">ìµœëŒ€ ê°€ê²© (1ì¸)</label>
                <div class="input-group">
                    <input type="number" name="max_price" class="form-control" placeholder="ì˜ˆ: 30000" value="{{ selected_max_price }}">
                    <span class="input-group-text">ì› ì´í•˜</span>
                </div>
            </div>

            <div class="col-12 d-flex justify-content-between align-items-end mt-3">
                <div class="sort-options">
                    <span class="fw-bold me-2">ì •ë ¬:</span>
                    <input type="radio" name="sort" value="latest" id="sort_latest" {% if sort_by == 'latest' %}checked{% endif %} onchange="this.form.submit()"> <label for="sort_latest" class="me-2">ìµœì‹ ìˆœ</label>
                    <input type="radio" name="sort" value="rating" id="sort_rating" {% if sort_by == 'rating' %}checked{% endif %} onchange="this.form.submit()"> <label for="sort_rating" class="me-2">í‰ì ìˆœ</label>
                    <input type="radio" name="sort" value="reviews" id="sort_reviews" {% if sort_by == 'reviews' %}checked{% endif %} onchange="this.form.submit()"> <label for="sort_reviews">ë¦¬ë·°ë§ì€ìˆœ</label>
                </div>
                
                <button type="submit" class="btn btn-primary px-4">ğŸ” ê²€ìƒ‰ ì ìš©</button>
            </div>

        </form>
    </div>

    <div class="theme-list">
        {% for theme in themes %}
            <a href="{% url 'theme-detail' theme.theme_id %}" style="text-decoration: none; color: inherit;">
                <div class="theme-card" style="border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px;" >
                    <h3>{{ theme.name }} <span style="font-size: 0.8em; color: #888;">({{ theme.branch.branch_name }})</span></h3>
                    <p>{{ theme.description }}</p>
                    <div class="details" style="color: #555;">
                        <span>ì¥ë¥´: {{ theme.genre }}</span> |
                        <span>ë‚œì´ë„: {{ theme.difficulty }}</span> |
                        <span>ì‹œê°„: {{ theme.duration }}ë¶„</span> |
                        <span>ê°€ê²©: {{ theme.price }}ì›</span>
                    </div>
                </div>
            </a> {% empty %}
            <p>ì¡°íšŒ ê°€ëŠ¥í•œ í…Œë§ˆê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endfor %}
    </div>
{% endblock %}