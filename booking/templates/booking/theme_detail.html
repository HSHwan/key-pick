{% extends 'booking/base.html' %}

{% block content %}
<div class="container">
    <div class="theme-detail-header" style="border-bottom: 2px solid #eee; padding-bottom: 20px; margin-bottom: 20px;">
        <h1>{{ theme.name }}</h1>
        <p><strong>지점:</strong> {{ theme.branch.branch_name }}</p>
        <p><strong>장르:</strong> {{ theme.genre }} | <strong>난이도:</strong> {{ theme.difficulty }} | <strong>시간:</strong> {{ theme.duration }}분</p>
        <p><strong>가격:</strong> {{ theme.price }}원</p>
        <hr>
        <p>{{ theme.description|linebreaks }}</p>
        
        <a href="{% url 'reservation-create' theme.theme_id %}" class="btn btn-primary">이 테마 예약하기</a>
    </div>

    <div class="review-section">
        <h2>리뷰 ({{ reviews.count }}개)</h2>
        <hr>
        {% for review in reviews %}
            <div class="review-card" style="border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 8px;">
                <p>
                    <strong>{{ review.member.name }}</strong>
                    <span style="color: #f0ad4e; font-weight: bold;">(★ {{ review.rating }})</span>
    
                    {% if review.member == user %}
                        <span style="margin-left: 10px; font-size: 0.9em;">
                            <a href="{% url 'review-update' review.review_id %}">수정</a>
                            |
                            <form action="{% url 'review-delete' review.review_id %}" method="POST" style="display: inline;">
                                {% csrf_token %}
                                <button type="submit" onclick="return confirm('이 리뷰를 삭제하시겠습니까?');" 
                                        style="background: none; border: none; color: #dc3545; cursor: pointer; text-decoration: underline; padding: 0;">
                                    삭제
                                </button>
                            </form>
                        </span>
                    {% endif %}
                </p>
                <p style="color: #777; font-size: 0.9em;">{{ review.created_at|date:"Y.m.d" }}</p>
                <p>{{ review.comment|linebreaks }}</p>
            </div>
        {% empty %}
            <p>아직 작성된 리뷰가 없습니다.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}